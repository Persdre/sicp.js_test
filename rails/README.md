# SICP online textbook in Javascript

## Description

This is the newer online version of SICP textbook in Javascript for CS1101S students. The goal is to improve the readability and aesthetics of the textbook, as well as to ease the future integration of the textbook with a new IDE. The current version is not yet integrated with an IDE, thus Javascript snippets are still displayed in a popup area on the textbook page and evaluated using Javascript's own `eval()` function.

It is also possible to generate a copy of the orginal textbook in Scheme. However evaluation of snippets are not yet supported and there are some missing images in the generated Scheme textbook.

## Requirements
For development & deployment:

* Rails 5.0.2
* Wget 1.19
* Java (for YUI Compressor)
* GNU Make 4.2

The generated web pages are static and can be hosted on any standard web servers.

## Overview

The original text is stored as xml files in the `xml` folder at the project root. 

The html pages are generated in two steps. In the first step, the xml pages are imported to a Rails application. The application has two models: `Chapter` and `Snippet`. Content from each xml file is stored in a corresponding `chapter` record, while each named snippet is stored as a `snippet`. 


## Configuration
Before deploying, change the configurations at `config/initializers/constants.rb.def`. 

`IDE_PREFIX`: The snippet and its requirements are sent through a GET request to the IDE. Change it to the correct URL and GET parameter name. Required snippets are sent by the name 'hidden'. To change this value, see the show method in `app/controllers/chapters_controller.rb`.

`GCSE_CX`: The search engine ID of Googel Custom Search. Create a new one [here](https://cse.google.com/cse/create/new).

## Deployment
Run `make javascript` or `make scheme` at the project root. The generated html pages and assets are saved in `rails-html` folder.

Run `make clean` to remove all generated pages, logs and temporary files.

## Development
...The pages are generated by a rails project and a static copy is made using Wget...

## Bugs
Google Custom Search doesn't seem to be working.
